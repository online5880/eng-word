# DTW

# 포인트주파수

### **코드 동작 과정**

#### 1. **음성 파일에서 포먼트 추출**

- `parselmouth.Sound`와 `snd.to_formant_burg()`를 사용해 음성 데이터를 분석.
- 각 시간 프레임에서 F1, F2 값을 추출.
- F1, F2 각각의 평균 값을 계산하여 음성 파일의 전반적인 발음 특징을 요약.

#### 2. **포먼트 차이 계산**

- 원어민(F1, F2)과 학생(F1, F2)의 평균 포먼트 값 차이 계산.
- 차이는 발음의 유사성을 나타냄. 차이가 작을수록 발음이 유사.

#### 3. **정규화 및 점수 계산**

- F1, F2의 차이 합을 기준으로 점수를 산출.
- 최대 차이 값(`max_diff`)을 사용해 정규화:
  $$
  \text{점수} = \max(0, 100 - \frac{\text{차이 합}}{2 \times \text{max_diff}} \times 100)
  $$
- 차이 합이 클수록 점수는 낮아짐. 차이가 전혀 없으면 점수는 100.

---

### **점수의 의미**

- 점수는 **학생의 발음이 원어민 발음과 얼마나 유사한지**를 나타냅니다.
  - **100점**: 완벽하게 유사한 발음.
  - **0점**: 발음이 전혀 유사하지 않음.
- 포먼트 차이가 매우 크면 점수는 0으로 제한되며, 발음이 비슷할수록 점수는 높아집니다.

---

### **해석 및 활용**

1. **F1, F2 차이 기반 평가**

   - 학생의 발음이 원어민 발음과 얼마나 유사한지 측정하는 지표로 사용.

2. **점수 정규화**

   - 포먼트 차이를 0~100 범위로 정규화하여 발음의 정확성을 직관적으로 제공.

3. **개선 지표**
   - 학생의 발음을 개선해야 할 영역(F1, F2)을 파악 가능.

---

### **한계점**

1. **모음에 민감**

   - 포먼트는 모음 발음에 더 민감하므로 자음 발음 차이는 반영하지 못할 수 있음.

2. **정규화 기준값의 주관성**

   - `max_diff` 값은 주관적으로 설정되므로, 분석하려는 데이터에 맞게 조정 필요.

3. **음성 파일 품질**
   - 음성 파일의 품질(잡음, 녹음 환경)에 따라 결과가 달라질 수

# vost

```
1. 발음 정확도 평가에 적합한 이유

    낮은 WER (Word Error Rate): vosk-model-en-us-0.22의 Word Error Rate(WER)은 5.69로, 이는 음성 인식에서 매우 낮은 편에 속합니다. WER이 낮을수록 인식 정확도가 높기 때문에, 발음 평가 시에도 정확한 텍스트 변환을 기대할 수 있습니다.
    정밀한 음성 인식: vosk-model-en-us-0.22는 다양한 미국 영어 발음을 정확하게 인식하도록 훈련되었습니다. 발음 평가에서는 학습자가 발음한 단어를 정확히 인식하는 것이 중요하므로, 이 모델의 높은 인식 정확도는 발음 평가에 큰 도움이 됩니다.
    다양한 상황에서의 적용 가능성: 이 모델은 다양한 데이터셋으로 훈련되어 일상적인 미국 영어 발음 인식에 최적화되어 있습니다. 이는 학습자의 발음이 원어민 발음에 어느 정도 근접한지를 평가하는 데 유용합니다.

2. 최근 사용 경향

    오프라인 음성 인식에서 인기: vosk-model-en-us-0.22는 오프라인 환경에서도 정확한 인식을 제공하기 때문에, 개인 데이터 보호가 중요한 환경이나 네트워크가 없는 환경에서 많이 사용되고 있습니다.
    발음 평가 및 언어 학습 응용 분야에서 사용: Vosk 모델은 최근 언어 학습 앱이나 발음 평가 시스템에서 많이 활용되고 있습니다. 오프라인으로도 사용할 수 있기 때문에, 온라인 API 사용에 제한이 있거나 비용이 걱정되는 경우 대안으로 많이 선택됩니다.
    학습 자료 분석 및 교육용 앱에서의 활용: 이 모델은 비교적 최신 데이터셋을 기반으로 훈련되었기 때문에, 교육 분야에서도 정확하고 신뢰성 있는 성능을 제공합니다.

3. 발음 평가에 좋은 이유 요약

    높은 정확도: 발음 평가에서는 학습자의 발음을 원어민 발음과 얼마나 유사한지를 측정해야 하는데, 이 모델은 높은 WER 성능을 제공하므로 학습자가 발음한 단어를 정확하게 인식하는 데 유리합니다.
    오프라인 작동: Vosk의 en-us-0.22 모델은 오프라인에서도 정확히 작동하여 비용이나 네트워크 문제 없이도 발음 평가가 가능합니다.
    다양한 발음에 대한 적응성: 학습자가 다양한 억양이나 발음으로 영어 단어를 발음할 때도 일정 수준의 정확도를 기대할 수 있습니다.
    따라서, vosk-model-en-us-0.22는 초등 수준 단어 발음 평가와 같은 용도에 있어서, 높은 정확도를 제공할 수 있는 좋은 선택입니다.

```

# 종합점수

## 발음 평가를 위한 가중치 설정에 대한 연구 및 추천

발음 평가 연구에서 **Phoneme-Level Accuracy(음소 정확도)**와 **Formant Analysis(포먼트 분석)**는 발음의 **정확성**과 **명료성**을 평가하는 중요한 지표입니다. 최신 연구들은 Phoneme-Level Accuracy에 더 높은 가중치를 부여하는 경향이 있습니다.

---

## 1. 각 지표의 역할

- **Phoneme-Level Accuracy**: 발음의 음소 단위 정확성을 평가하여 단어 발음이 예상 단어와 얼마나 유사한지를 판단합니다. 발음의 정확도를 평가하는 데 핵심적인 요소입니다.
- **Formant Analysis**: 발음의 음질과 모음 발음의 주파수 영역을 평가하여 발음의 명료성을 판단합니다. 발음의 자연스러움과 음질을 측정하는 데 유용합니다.

---

## 2. 관련 연구 및 권장 가중치

### (1) Automatic Pronunciation Evaluation 연구

- **논문**: "Automatic Pronunciation Evaluation of Second Language Learners Using Phoneme-level Features"
- **내용**: Phoneme-Level Accuracy가 발음 평가에서 중요한 요소로, 특히 학습자의 발음 정확도를 높게 평가하는 지표임을 강조.
- **결론**: Phoneme-Level Accuracy에 더 높은 가중치를 두는 것이 발음 평가에 효과적임을 확인.

### (2) Formant-based Pronunciation Scoring 연구

- **논문**: "Improving Pronunciation Assessment using Formant Features"
- **내용**: Formant Analysis가 발음의 음질과 명료성을 평가하는 데 유용하나, 정확도 측면에서는 Phoneme-Level Accuracy가 더 중요한 역할을 함.
- **결론**: Phoneme-Level Accuracy에 더 높은 가중치를 부여하고, Formant Score는 보조 지표로 사용을 권장.

### (3) 종합 발음 평가 시스템 연구

- **논문**: "A Comprehensive Framework for Automatic Pronunciation Evaluation"
- **내용**: 발음 평가에서 Phoneme-Level Accuracy와 Formant Score의 가중치를 각각 0.6과 0.4로 설정하는 것을 추천. 두 지표가 상호 보완적인 역할을 함.
- **결론**: 발음 정확성을 평가하기 위해 Phoneme-Level Accuracy에 더 높은 가중치를 설정하는 것이 적절.

---

## 3. 최종 가중치 설정 (추천)

- **Phoneme-Level Accuracy**: 0.7 (발음의 정확성을 직접적으로 평가)
- **Formant Score**: 0.3 (발음의 음질과 명료성을 평가)
- 초등학생이기 때문

### 가중치 설정 이유

Phoneme-Level Accuracy는 발음의 정확성을 판단하는 데 가장 중요한 요소이며, Formant Score는 보조적으로 발음의 음질을 평가하는 요소로 작용합니다. 연구에 따르면 Phoneme-Level Accuracy에 더 높은 가중치를 두는 것이 발음 평가의 신뢰성을 높이는 데 효과적입니다.

---

## 정규화 과정도 추가

### **정규화를 해야 하는 이유**

---

### **1. 두 가지 지표의 점수 계산 방식**

#### **(1) 포먼트 점수 (Formant Score)**

- **계산 방식:**
  - 학생과 원어민 발음의 **F1, F2 주파수 평균 차이**를 기반으로 계산.
  - 점수는 다음 식으로 계산:
    $$
    \text{포먼트 점수} = \max(0, 100 - \frac{\text{F1 차이} + \text{F2 차이}}{2 \times \text{최대 차이}} \times 100)
    $$
- **특징:**
  - 차이가 클수록 점수는 0에 가까워짐.
  - **포먼트 차이는 물리적 발음 차이를 반영**하기 때문에 상대적으로 작은 수치일 가능성이 큼.
  - 실험적으로 계산된 점수의 범위: **40~90 사이**.

#### **(2) 음소 점수 (Phoneme Score)**

- **계산 방식:**
  - 음성 인식 결과(텍스트)와 예상 단어 간의 **유사도(SequenceMatcher)**를 기반으로 계산.
  - 점수는 다음 식으로 계산:
    $$
    \text{음소 점수} = \text{텍스트 유사도 비율} \times 100
    $$
- **특징:**
  - 예상 단어와 유사성이 높으면 점수는 100에 가까움.
  - **텍스트 기반 유사도는 발음 정확성을 평가**하며, 점수 분포가 더 넓음 (예: 0~100 사이).

---

### **2. 정규화가 필요한 이유**

#### **(1) 점수 범위가 서로 다름**

- 포먼트 점수와 음소 점수는 **다른 단위와 범위**로 계산됨.
  - 포먼트 점수: 음향학적 차이에 기반하며 일반적으로 **40~90 사이**에서 분포.
  - 음소 점수: 텍스트 유사도를 기반으로 하며 **0~100 사이**에서 분포.
- 두 점수의 범위가 다르면, **한쪽 점수가 종합 점수에 더 큰 영향을 미칠 위험**이 있음.
  - 예: 음소 점수(90)가 포먼트 점수(50)에 비해 종합 점수에서 더 큰 비중을 차지.

#### **(2) 점수의 상대적 기여도 균형**

- 가중치(예: 0.3, 0.7)를 적용해도, 두 점수의 **스케일 차이** 때문에 한쪽 점수가 결과에 과도한 영향을 미칠 수 있음.
  - 예: 음소 점수는 90, 포먼트 점수는 50일 때, 종합 점수는 음소 점수에 편향됨.
- 정규화하면 두 점수를 동일한 스케일(0~100)로 조정하여 **비교 가능성**을 높이고, 가중치가 의미 있는 기여도를 반영할 수 있음.

---

### **3. 정규화의 효과**

#### **정규화 전 문제**

- 포먼트 점수 = 50, 음소 점수 = 90일 경우:
  $$
  \text{종합 점수} = (50 \times 0.3) + (90 \times 0.7) = 15 + 63 = 78
  $$
- 음소 점수의 범위가 크기 때문에, 포먼트 점수의 기여도가 낮아짐.

#### **정규화 후 해결**

- 포먼트 점수와 음소 점수를 **0~100 사이로 정규화**:
  - 포먼트 점수 정규화:
    $$
    (50 - 40) / (90 - 40) \times 100 = 20
    $$
  - 음소 점수 정규화:
    $$
    (90 - 0) / (100 - 0) \times 100 = 90
    $$
- 정규화된 점수를 기반으로 계산:
  $$
  \text{종합 점수} = (20 \times 0.3) + (90 \times 0.7) = 6 + 63 = 69
  $$
- 정규화 후, 두 점수의 상대적 기여도가 더 균형 있게 반영됨.

---

### **4. 결론**

#### **정규화를 적용해야 하는 이유:**

1. 포먼트 점수와 음소 점수의 스케일 차이를 해소하여, 두 점수의 기여도를 균형 있게 반영.
2. 가중치 설정이 실제 평가에 효과적으로 반영되도록 보장.

#### **정규화의 이점:**

- 학생의 발음 평가를 공정하게 수행.
- 종합 점수가 데이터 특성이나 점수 범위의 영향을 덜 받음.
- 가중치가 의미 있는 방식으로 작동하도록 보장.
